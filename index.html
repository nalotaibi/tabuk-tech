<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <link rel="apple-touch-icon" href="1024.png">
    <link rel="icon" href="1024.png">
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ø­Ø§Ø³Ø¨Ø© Ø§Ù„ØºÙŠØ§Ø¨</title>

    <style>
        :root {
            /* Ø£Ù„ÙˆØ§Ù† Ù…Ø³ØªÙˆØ­Ø§Ø© Ù…Ù† Ø®Ù„ÙÙŠØ© Ø§Ù„Ø¨ÙˆØ³ØªØ± (ØªØ¯Ø±Ø¬Ø§Øª Ø§Ù„Ø£Ø²Ø±Ù‚ ÙˆØ§Ù„Ø³ÙŠØ§Ù†) */
            --primary: #006699;      /* Ø§Ù„Ø£Ø²Ø±Ù‚ Ø§Ù„Ù…Ù„ÙƒÙŠ Ø§Ù„Ø¯Ø§ÙƒÙ† */
            --secondary: #00aed9;    /* Ø§Ù„ÙÙŠØ±ÙˆØ²ÙŠ (Ø§Ù„Ø³ÙŠØ§Ù†) Ø§Ù„Ù…Ø´Ø±Ù‚ */
            --text-dark: #2c3e50;    /* ÙƒØ­Ù„ÙŠ ØºØ§Ù…Ù‚ Ù„Ù„Ù†ØµÙˆØµ */

            --safe: #22c55e;
            --warning: #facc15;
            --orange: #fb923c;
            --danger: #ef4444;

            /* ØªØ¯Ø±Ø¬ Ø®Ù„ÙÙŠØ© Ù…Ø·Ø§Ø¨Ù‚ Ù„Ù„Ø¨ÙˆØ³ØªØ± */
            --bg-gradient: linear-gradient(135deg, #e6f4f8 0%, #ffffff 100%);

            /* Ø£Ù„ÙˆØ§Ù† Ù†Ø§ÙØ°Ø© Ø§Ù„Ù…Ø¹Ù„ÙˆÙ…Ø© (Ø¨Ø¯ÙŠÙ„Ø© Ø¹Ù† alert) */
            --info-modal-bg: #1F2937;
            --info-modal-text: #F8FAFC;
            --info-modal-accent: #0EA5E9;
        }

        body {
            margin: 0;
            font-family: 'Segoe UI', Tahoma, sans-serif;
            background: var(--bg-gradient);
            padding: 20px 10px;
            direction: rtl;
            min-height: 100vh;
        }

        /* ===== Guide Modal ===== */
        .modal-overlay {
            display: none;
            position: fixed;
            top: 0; left: 0; right: 0; bottom: 0;
            width: 100%; height: 100%;
            background: rgba(0,0,0,0.7);
            z-index: 9999;
            justify-content: center;
            align-items: center;
        }

        .modal-content {
            background: white;
            padding: 25px 20px;
            border-radius: 24px;
            width: 85%;
            max-width: 340px;
            position: relative;
            box-shadow: 0 20px 40px rgba(0,0,0,0.2);
            text-align: center;
            box-sizing: border-box;
            margin: 0;
        }

        .modal-header {
            font-weight: 800;
            color: var(--primary);
            margin-bottom: 20px;
            font-size: 1.1rem;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
        }

        .guide-item {
            margin-bottom: 20px;
            font-size: 0.9rem;
            line-height: 1.6;
            color: #333;
            text-align: center;
            width: 100%;
            display: block;
        }

        .guide-item b {
            color: var(--primary);
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            margin-bottom: 8px;
            font-size: 1rem;
            width: 100%;
        }

        .close-modal {
            background: var(--primary);
            color: white;
            border: none;
            padding: 12px;
            border-radius: 12px;
            width: 100%;
            margin-top: 10px;
            cursor: pointer;
            font-weight: bold;
        }

        .install-banner {
            background: #ffffff;
            border: 1px solid #e1e9e7;
            padding: 10px 15px;
            border-radius: 16px;
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            justify-content: space-between;
            box-shadow: 0 4px 12px rgba(0,0,0,0.03);
        }

        .install-text { font-weight: 700; color: var(--primary); font-size: 0.82rem; }

        .install-btn {
            background: var(--secondary);
            color: white;
            border: none;
            padding: 6px 14px;
            border-radius: 10px;
            font-size: 0.78rem;
            font-weight: bold;
            cursor: pointer;
        }

        .app-container { max-width: 450px; margin: 0 auto; }
        .header-section { text-align: center; margin-bottom: 20px; }
        .college-logo img { width: 200px; margin-bottom: 10px; filter: drop-shadow(0 2px 5px rgba(0,0,0,0.1)); }
        .header-text h1 { margin: 0; font-size: 1.6rem; color: var(--primary); font-weight: 800; }
        .system-badge { display: inline-block; margin-top: 8px; padding: 4px 12px; background: #e0f2f1; color: #00796b; border-radius: 20px; font-size: 0.75rem; font-weight: bold; }

        .action-bars { display: flex; gap: 10px; margin: 20px 0; }
        .add-btn {
            flex: 2;
            padding: 14px;
            background: linear-gradient(135deg, var(--primary) 0%, var(--secondary) 100%);
            color: white;
            border: none;
            border-radius: 16px;
            font-weight: bold;
            cursor: pointer;
            font-size: 1rem;
            box-shadow: 0 4px 12px rgba(0, 102, 153, 0.2);
        }
        .reset-all { flex: 1; padding: 14px; background: #fff; color: var(--primary); border: 1px solid var(--primary); border-radius: 16px; cursor: pointer; font-weight: bold; }

        .course-card { background: white; border-radius: 28px; padding: 22px; margin-bottom: 20px; box-shadow: 0 12px 30px rgba(0,0,0,0.06); border: 1px solid #d1e2e8; position: relative; }
        .delete-course { position: absolute; top: 18px; left: 18px; background: #fee2e2; color: #ef4444; border: none; width: 28px; height: 28px; border-radius: 50%; cursor: pointer; display: flex; align-items: center; justify-content: center; }
        .course-title { width: 85%; border: none; border-bottom: 2px solid #f0f0f0; font-size: 1.1rem; font-weight: bold; color: var(--primary); margin-bottom: 15px; padding: 5px; outline: none; background: transparent; }

        .input-group { margin-bottom: 12px; }
        .input-group label { display: block; font-size: 0.8rem; color: #444; margin-bottom: 6px; font-weight: 700; background: #f0f7f9; padding: 4px 10px; border-right: 3px solid var(--secondary); }

        select, input { width: 100%; padding: 10px; border-radius: 12px; border: 1.5px solid #edf2f1; font-family: inherit; text-align: center; font-size: 0.95rem; outline: none; box-sizing: border-box; transition: all 0.3s; }
        input:focus { border-color: var(--secondary); background: #f8fdff; }
        .flex-inputs { display: flex; gap: 8px; align-items: flex-end; }
        .flex-inputs > div { flex: 1; }
        .input-sub-label { font-size: 0.7rem; color: #666; margin-bottom: 4px; display: block; font-weight: 600; text-align: center; }

        .hint-icon { display: inline-flex; align-items: center; justify-content: center; width: 14px; height: 14px; background: var(--secondary); color: white; border-radius: 50%; font-size: 0.65rem; margin-right: 4px; cursor: pointer; font-weight: bold; vertical-align: middle; }

        /* ===== Info icon (Ù…ÙØ­Ø³Ù‘Ù†) ===== */
        .info-icon {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            width: 18px;
            height: 18px;
            background: var(--info-modal-accent);
            color: white;
            border-radius: 999px;
            font-size: 0.78rem;
            margin-right: 6px;
            cursor: pointer;
            font-weight: 900;
            vertical-align: middle;
            box-shadow: 0 6px 14px rgba(14,165,233,0.25);
            transition: transform 0.15s ease, filter 0.15s ease, background 0.2s ease;
        }
        .info-icon:hover { filter: brightness(1.05); }
        .info-icon:active { transform: translateY(1px) scale(0.98); }

        /* ØªØºÙŠÙŠØ± Ù„ÙˆÙ† Ø§Ù„Ø£ÙŠÙ‚ÙˆÙ†Ø© Ø­Ø³Ø¨ Ø§Ù„Ø­Ø§Ù„Ø© */
        .info-icon.warn { background: var(--orange); box-shadow: 0 6px 14px rgba(251,146,60,0.25); }
        .info-icon.danger { background: var(--danger); box-shadow: 0 6px 14px rgba(239,68,68,0.25); }

        .result-area { border-radius: 20px; padding: 15px; margin-top: 15px; text-align: center; }
        .safe-bg { background: #f0fdf4; border: 1px solid #dcfce7; }
        .warning-bg { background: #fffbeb; border: 1px solid #fef3c7; }
        .danger-bg { background: #fef2f2; border: 1px solid #fee2e2; }

        .progress-bar { height: 8px; background: #e5e7eb; border-radius: 4px; margin: 10px 0; overflow: hidden; }
        .progress-fill { height: 100%; width: 0%; transition: 0.8s ease-in-out; }

        .advice-box { margin-top: 10px; padding-top: 10px; border-top: 1px dashed rgba(0,0,0,0.1); font-size: 0.85rem; color: #444; line-height: 1.4; }
        .advice-box b { color: var(--primary); }

        .footer-note { text-align: center; font-size: 0.8rem; color: #718096; margin-top: 40px; border-top: 1px solid #d1d9e6; padding-top: 20px; }

        /* ===== Info Modal (Ø¨Ø¯ÙŠÙ„ alert) ===== */
        .info-overlay{
            display:none;
            position:fixed;
            inset:0;
            background: rgba(15, 23, 42, 0.55);
            z-index: 10000;
            justify-content:center;
            align-items:center;
            padding: 14px;
        }

        .info-modal{
            width: 92%;
            max-width: 360px;
            background: var(--info-modal-bg);
            color: var(--info-modal-text);
            border-radius: 20px;
            box-shadow: 0 18px 45px rgba(0,0,0,0.35);
            overflow: hidden;
            border: 1px solid rgba(255,255,255,0.08);
        }

        .info-modal-header{
            display:flex;
            align-items:center;
            justify-content:space-between;
            padding: 14px 16px;
            border-bottom: 1px solid rgba(255,255,255,0.08);
        }

        .info-modal-title{
            display:flex;
            align-items:center;
            gap:10px;
            font-weight: 900;
            font-size: 0.95rem;
        }

        .info-badge{
            width: 28px;
            height: 28px;
            border-radius: 10px;
            display:flex;
            align-items:center;
            justify-content:center;
            background: rgba(14,165,233,0.18);
            color: var(--info-modal-accent);
            font-weight: 900;
        }

        .info-close{
            background: transparent;
            border: none;
            color: rgba(248,250,252,0.75);
            font-size: 1.1rem;
            cursor: pointer;
            padding: 6px 10px;
            border-radius: 10px;
        }
        .info-close:hover{
            background: rgba(255,255,255,0.06);
            color: var(--info-modal-text);
        }

        .info-modal-body{
            padding: 14px 16px 6px 16px;
            font-size: 0.92rem;
            line-height: 1.7;
        }

        /* âœ… Ø§Ù„Ù…Ø¹Ø§Ø¯Ù„Ø© Ù…Ù† Ø§Ù„ÙŠÙ…ÙŠÙ† Ù„Ù„ÙŠØ³Ø§Ø± */
        .info-formula{
            margin-top: 10px;
            background: rgba(255,255,255,0.06);
            border: 1px solid rgba(255,255,255,0.08);
            padding: 10px 12px;
            border-radius: 14px;
            color: var(--info-modal-text);
            font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;
            font-size: 0.86rem;

            direction: rtl;
            unicode-bidi: isolate-override;
            text-align: center;

            white-space: nowrap;
            overflow-x: auto;
        }

        .info-modal-footer{
            padding: 12px 16px 16px 16px;
        }

        .info-ok{
            width:100%;
            background: var(--info-modal-accent);
            color: white;
            border: none;
            border-radius: 14px;
            padding: 12px 14px;
            font-weight: 900;
            cursor: pointer;
            box-shadow: 0 6px 14px rgba(14,165,233,0.25);
        }
        .info-ok:active{
            transform: translateY(1px);
        }
    </style>
</head>

<body>

<!-- Guide Modal -->
<div id="guideModal" class="modal-overlay">
    <div class="modal-content">
        <div class="modal-header">
            <span>ğŸ“±</span>
            <span>Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ø­Ø§Ø³Ø¨Ø© Ù„Ù„ØµÙØ­Ø© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©</span>
        </div>
        <div class="guide-item">
            <b>ğŸ Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠ iPhone (Safari)</b>
            Ø§Ø¶ØºØ· Ø¹Ù„Ù‰ Ø£ÙŠÙ‚ÙˆÙ†Ø© Ø§Ù„Ù…Ø´Ø§Ø±ÙƒØ© â¬†ï¸ <br>
            Ø«Ù… Ø§Ø®ØªØ§Ø± <b>"Ø¥Ø¶Ø§ÙØ© Ø¥Ù„Ù‰ Ø§Ù„ØµÙØ­Ø© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©"</b>
        </div>
        <div class="guide-item">
            <b>ğŸ¤– Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠ Android (Chrome)</b>
            Ø§Ø¶ØºØ· Ø¹Ù„Ù‰ Ø§Ù„Ù†Ù‚Ø§Ø· Ø§Ù„Ø«Ù„Ø§Ø« â‹® <br>
            Ø«Ù… Ø§Ø®ØªØ§Ø± <b>"Ø¥Ø¶Ø§ÙØ© Ø¥Ù„Ù‰ Ø§Ù„ØµÙØ­Ø© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©"</b>
        </div>
        <button class="close-modal" onclick="toggleModal(false)">ÙÙ‡Ù…Øª Ø°Ù„Ùƒ</button>
    </div>
</div>

<!-- Info Modal (Ø¨Ø¯ÙŠÙ„ alert) -->
<div id="infoOverlay" class="info-overlay" onclick="closeInfoModal()">
    <div class="info-modal" onclick="event.stopPropagation()">
        <div class="info-modal-header">
            <div class="info-modal-title">
                <span class="info-badge">i</span>
                <span id="infoTitle">Ù…Ø¹Ù„ÙˆÙ…Ø©</span>
            </div>
            <button class="info-close" onclick="closeInfoModal()">âœ•</button>
        </div>

        <div class="info-modal-body">
            <div id="infoText"></div>
            <div id="infoFormula" class="info-formula" style="display:none;"></div>
        </div>

        <div class="info-modal-footer">
            <button class="info-ok" onclick="closeInfoModal()">ÙÙ‡Ù…Øª</button>
        </div>
    </div>
</div>

<div class="app-container">
    <div class="install-banner">
        <div class="install-text">Ø§Ø³ØªØ®Ø¯Ù… Ø§Ù„Ø­Ø§Ø³Ø¨Ø© ÙƒØªØ·Ø¨ÙŠÙ‚ Ø¹Ù„Ù‰ Ù‡Ø§ØªÙÙƒ Ø§Ù„Ø°ÙƒÙŠ</div>
        <button class="install-btn" onclick="toggleModal(true)">Ø·Ø±ÙŠÙ‚Ø© Ø§Ù„Ø¥Ø¶Ø§ÙØ©</button>
    </div>

    <header class="header-section">
        <div class="college-logo"><img src="TVTC_identity.png" alt="Logo"></div>
        <div class="header-text">
            <h1>Ø­Ø§Ø³Ø¨Ø© Ø§Ù„ØºÙŠØ§Ø¨ Ø§Ù„Ø°ÙƒÙŠØ©</h1>
            <span class="system-badge">Ù†Ø¸Ø§Ù… 16 Ø£Ø³Ø¨ÙˆØ¹Ù‹Ø§ (20% Ø­Ø±Ù…Ø§Ù†)</span>
        </div>
    </header>

    <div class="action-bars">
        <button class="add-btn" onclick="addNewCourse()">â• Ø¥Ø¶Ø§ÙØ© Ù…Ù‚Ø±Ø± Ø¬Ø¯ÙŠØ¯</button>
        <button class="reset-all" onclick="clearEverything()">Ø¥Ø¹Ø§Ø¯Ø© Ø¶Ø¨Ø·</button>
    </div>

    <div id="coursesList"></div>

    <footer class="footer-note">
        <div style="display: flex; flex-direction: column; align-items: center; justify-content: center;">
            <p style="font-weight: bold; color: var(--primary); margin: 0 0 5px 0;">ØªØµÙ…ÙŠÙ… ÙˆØªØ·ÙˆÙŠØ±: Ø£. Ù†ÙˆØ±Ø© Ø§Ù„Ù‚Ø«Ø§Ù…ÙŠ</p>
            <p style="margin: 2px 0; color: #555; font-size: 0.8rem;">Ù‚Ø³Ù… Ø§Ù„Ø­Ø§Ø³Ø¨ ÙˆØªÙ‚Ù†ÙŠØ© Ø§Ù„Ù…Ø¹Ù„ÙˆÙ…Ø§Øª</p>
            <p style="margin: 2px 0; color: #555; font-size: 0.8rem;">Ø§Ù„ÙƒÙ„ÙŠØ© Ø§Ù„ØªÙ‚Ù†ÙŠØ© Ø§Ù„Ø±Ù‚Ù…ÙŠØ© Ù„Ù„Ø¨Ù†Ø§Øª Ø¨ØªØ¨ÙˆÙƒ</p>
            <p style="margin: 2px 0; color: #555; font-size: 0.8rem;">1447Ù‡Ù€ | 2026Ù…</p>
            <a href="mailto:norah.a@tvtc.gov.sa" style="text-decoration: none; color: #555; font-size: 0.8rem; dir: ltr; margin-top: 5px;">ğŸ“§ norah.a@tvtc.gov.sa</a>
            <div style="margin-top: 10px;">
                <a href="https://www.freecounterstat.com" target="_blank" rel="noreferrer">
                    <img src="https://counter1.optistats.ovh/private/freecounterstat.php?c=pt4x3lgqdkek5gqe8qd7ekhfb1ezkp4m" border="0" title="Ø¹Ø¯Ø§Ø¯ Ø§Ù„Ø²ÙŠØ§Ø±Ø§Øª" alt="counter">
                </a>
            </div>
        </div>
    </footer>
</div>

<script>
    let courses = JSON.parse(localStorage.getItem('myCourses')) || [];

    function toggleModal(show) {
        const modal = document.getElementById('guideModal');
        modal.style.display = show ? 'flex' : 'none';
    }

    function fixNumbers(str) {
        return str
            .replace(/[Ù -Ù©]/g, function(d) { return d.charCodeAt(0) - 1632; })
            .replace(/[^\d.]/g, '');
    }

    function addNewCourse() {
        courses.push({ id: Date.now(), name: 'Ø§Ø³Ù… Ø§Ù„Ù…Ù‚Ø±Ø±', weeklyHours: 4, absent1: '', absent2: '' });
        renderCourses();
    }

    /* ===== Info Modal Functions ===== */
    function openInfoModal({title='Ù…Ø¹Ù„ÙˆÙ…Ø©', text='', formula=''}) {
        document.getElementById('infoTitle').textContent = title;
        document.getElementById('infoText').innerHTML = text;

        const f = document.getElementById('infoFormula');
        if (formula && formula.trim() !== '') {
            f.style.display = 'block';
            f.textContent = formula;
        } else {
            f.style.display = 'none';
            f.textContent = '';
        }

        document.getElementById('infoOverlay').style.display = 'flex';
    }

    function closeInfoModal() {
        document.getElementById('infoOverlay').style.display = 'none';
    }

    function openLimitInfo(weeklyH, limit) {
        // âœ… ØµÙŠØ§ØºØ© Ø¹Ø±Ø¨ÙŠØ© ØªÙÙ‚Ø±Ø£ RTL
        const formula = `( ${weeklyH} Ø³Ø§Ø¹Ø§Øª Ø£Ø³Ø¨ÙˆØ¹ÙŠØ§Ù‹ Ã— 16 Ø£Ø³Ø¨ÙˆØ¹ ) Ã— 20% = ${Number(limit).toFixed(1)} Ø³Ø§Ø¹Ø©`;

        openInfoModal({
            title: 'Ø·Ø±ÙŠÙ‚Ø© Ø§Ù„Ø­Ø³Ø§Ø¨',
            text: 'ğŸ“˜ Ø·Ø±ÙŠÙ‚Ø© Ø­Ø³Ø§Ø¨ Ø³Ø§Ø¹Ø§Øª Ø§Ù„Ø­Ø±Ù…Ø§Ù† Ù„Ù‡Ø°Ø§ Ø§Ù„Ù…Ù‚Ø±Ø±:',
            formula: formula
        });
    }

    function renderCourses() {
        const list = document.getElementById('coursesList');
        list.innerHTML = '';

        courses.forEach(course => {
            const weeklyH = parseFloat(course.weeklyHours) || 0;
            const totalHours = weeklyH * 16;
            const limit = totalHours * 0.20;
            const currentAbsent = (parseFloat(course.absent1) || 0) + ((parseFloat(course.absent2) || 0) * 2);
            const percent = (currentAbsent / totalHours) * 100 || 0;
            const remaining = limit - currentAbsent;

            let statusClass = 'safe-bg', statusColor = 'var(--safe)', msg = 'ğŸŸ¢ ÙˆØ¶Ø¹Ùƒ Ø¢Ù…Ù† ÙˆÙ…Ø³ØªÙ‚Ø±';
            let infoIconClass = '';

            if (currentAbsent > limit) {
                statusClass = 'danger-bg';
                statusColor = 'var(--danger)';
                msg = 'ğŸ”´ Ø­Ø§Ù„Ø© Ø­Ø±Ù…Ø§Ù†';
                infoIconClass = 'danger';
            } else if (percent >= 15) {
                statusClass = 'warning-bg';
                statusColor = 'var(--orange)';
                msg = 'ğŸŸ  ØªÙ†Ø¨ÙŠÙ‡: Ø§Ù‚ØªØ±Ø¨Øª Ù…Ù† Ø§Ù„Ø­Ø±Ù…Ø§Ù†';
                infoIconClass = 'warn';
            } else if (percent >= 10) {
                statusClass = 'warning-bg';
                statusColor = 'var(--warning)';
                msg = 'ğŸŸ¡ Ø§Ù†ØªØ¨Ø§Ù‡: Ø¨Ø¯Ø£ Ø±ØµÙŠØ¯Ùƒ Ø¨Ø§Ù„Ù†Ù‚ØµØ§Ù†';
                infoIconClass = 'warn';
            }

            let advice = "";
            if (currentAbsent <= limit) {
                const remHours = Math.floor(remaining);
                let detail = "";

                if (weeklyH === 1 || weeklyH === 2 || weeklyH === 4) {
                    const unit = (weeklyH === 1) ? 1 : 2;
                    const count = Math.floor(remHours / unit);
                    const word = (count >= 3 && count <= 10) ? "Ù…Ø­Ø§Ø¶Ø±Ø§Øª" : (count === 2) ? "Ù…Ø­Ø§Ø¶Ø±ØªÙŠÙ†" : "Ù…Ø­Ø§Ø¶Ø±Ø©";
                    detail = `<b>${count}</b> ${word}`;
                } else {
                    const lec2 = Math.floor(remHours / 2);
                    const lec1 = remHours % 2;
                    if (lec2 > 0 && lec1 > 0) {
                        let w2 = (lec2 >= 3) ? "Ù…Ø­Ø§Ø¶Ø±Ø§Øª" : (lec2 === 2) ? "Ù…Ø­Ø§Ø¶Ø±ØªÙŠÙ†" : "Ù…Ø­Ø§Ø¶Ø±Ø© ÙˆØ§Ø­Ø¯Ø©";
                        detail = `<b>${lec2}</b> ${w2} (Ø³Ø§Ø¹ØªÙŠÙ†) Ùˆ <b>1</b> Ù…Ø­Ø§Ø¶Ø±Ø© (Ø³Ø§Ø¹Ø©)`;
                    } else if (lec2 > 0) {
                        let w = (lec2 >= 3 && lec2 <= 10) ? "Ù…Ø­Ø§Ø¶Ø±Ø§Øª" : (lec2 === 2) ? "Ù…Ø­Ø§Ø¶Ø±ØªÙŠÙ†" : "Ù…Ø­Ø§Ø¶Ø±Ø© ÙˆØ§Ø­Ø¯Ø©";
                        detail = `<b>${lec2}</b> ${w} (Ø³Ø§Ø¹ØªÙŠÙ†)`;
                    } else if (lec1 > 0) {
                        detail = `<b>1</b> Ù…Ø­Ø§Ø¶Ø±Ø© (Ø³Ø§Ø¹Ø©)`;
                    } else { detail = "Ø£Ù‚Ù„ Ù…Ù† Ø³Ø§Ø¹Ø©"; }
                }

                advice = `<div class="advice-box">Ù…ØªØ¨Ù‚ÙŠ Ù„Ùƒ <b>${remHours}</b> Ø³Ø§Ø¹Ø©: ÙŠÙØ¹Ø§Ø¯Ù„ ${detail}</div>`;
            } else {
                advice = `<div class="advice-box" style="color:var(--danger); font-weight:bold;">ØªØ¬Ø§ÙˆØ²Øª Ø§Ù„Ø­Ø¯ Ø§Ù„Ù…Ø³Ù…ÙˆØ­ (${limit.toFixed(1)} Ø³Ø§Ø¹Ø©)</div>`;
            }

            const isComplexType = (weeklyH === 3 || weeklyH === 5);
            const showAbsent2 = (weeklyH >= 2);
            const showAbsent1 = (weeklyH === 1 || weeklyH === 3 || weeklyH === 5);

            const card = document.createElement('div');
            card.className = 'course-card';

            card.innerHTML = `
                <button class="delete-course" onclick="deleteCourse(${course.id})">âœ•</button>
                <input type="text" class="course-title" value="${course.name}" onchange="updateCourse(${course.id}, 'name', this.value)">
                <div class="input-group">
                    <label>Ø¹Ø¯Ø¯ Ø§Ù„Ø³Ø§Ø¹Ø§Øª Ø§Ù„Ø£Ø³Ø¨ÙˆØ¹ÙŠØ© Ù„Ù„Ù…Ù‚Ø±Ø±</label>
                    <select onchange="updateCourse(${course.id}, 'weeklyHours', this.value)">
                        ${[1,2,3,4,5,6].map(h => `<option value="${h}" ${course.weeklyHours == h ? 'selected' : ''}>${h} Ø³Ø§Ø¹Ø§Øª</option>`).join('')}
                    </select>
                </div>
                <div class="input-group">
                    <label> Ø¹Ø¯Ø¯ Ù…Ø±Ø§Øª Ø§Ù„ØºÙŠØ§Ø¨ </label>
                    <div class="flex-inputs">
                        ${showAbsent2 ? `<div>
                            ${isComplexType ? `
                            <span class="input-sub-label">
                                <span class="hint-icon" onclick="alert('ğŸ’¡ Ù…Ø­Ø§Ø¶Ø±Ø© ÙØ¦Ø© Ø³Ø§Ø¹ØªÙŠÙ†:\\nÙŠÙÙ‚ØµØ¯ Ø¨Ù‡Ø§ Ø§Ù„Ù…Ø­Ø§Ø¶Ø±Ø§Øª Ø§Ù„Ø·ÙˆÙŠÙ„Ø© Ø§Ù„ØªÙŠ ØªÙØ­Ø³Ø¨ Ø¨Ù€Ø³Ø§Ø¹ØªÙŠÙ† ØºÙŠØ§Ø¨ Ø¹Ù†Ø¯ Ø§Ù„ØªØºÙŠØ¨ Ø¹Ù†Ù‡Ø§ Ù…Ø±Ø© ÙˆØ§Ø­Ø¯Ø©.')">?</span>
                                (Ù…Ø­Ø§Ø¶Ø±Ø© ÙØ¦Ø© Ø³Ø§Ø¹ØªÙŠÙ†)
                            </span>` : ''}
                            <input type="text" inputmode="numeric" value="${course.absent2}" placeholder="0" oninput="handleInput(${course.id}, 'absent2', this)">
                        </div>` : ''}
                        ${showAbsent1 ? `<div>
                            ${isComplexType ? `
                            <span class="input-sub-label">
                                <span class="hint-icon" onclick="alert('ğŸ’¡ Ù…Ø­Ø§Ø¶Ø±Ø© ÙØ¦Ø© Ø³Ø§Ø¹Ø©:\\nÙŠÙÙ‚ØµØ¯ Ø¨Ù‡Ø§ Ø§Ù„Ù…Ø­Ø§Ø¶Ø±Ø§Øª Ø§Ù„Ù‚ØµÙŠØ±Ø© Ø§Ù„ØªÙŠ ØªÙØ­Ø³Ø¨ Ø¨Ù€Ø³Ø§Ø¹Ø© ØºÙŠØ§Ø¨ ÙˆØ§Ø­Ø¯Ø© ÙÙ‚Ø·.')">?</span>
                                (Ù…Ø­Ø§Ø¶Ø±Ø© ÙØ¦Ø© Ø³Ø§Ø¹Ø©)
                            </span>` : ''}
                            <input type="text" inputmode="numeric" value="${course.absent1}" placeholder="0" oninput="handleInput(${course.id}, 'absent1', this)">
                        </div>` : ''}
                    </div>
                </div>
                <div class="result-area ${statusClass}">
                    <div style="font-size:0.95rem; font-weight:800; color:${statusColor}; margin-bottom:10px;">${msg}</div>
                    <div style="display:flex; justify-content:space-between; align-items:baseline; margin-bottom:5px;">
                        <span style="font-size:1.8rem; font-weight:900; color:var(--primary);">${percent.toFixed(1)}%</span>
                        <span style="font-size:0.85rem; color:#718096; font-weight:bold;">Ù…Ù† Ø£ØµÙ„ 20%</span>
                    </div>
                    <div class="progress-bar"><div class="progress-fill" style="width:${Math.min((percent/20)*100, 100)}%; background:${statusColor}"></div></div>
                    <div style="display:flex; justify-content:space-between; font-size:0.8rem; color:#555; font-weight:700; margin-top:5px;">
                        <span>ØºÙŠØ§Ø¨Ùƒ Ø§Ù„Ø­Ø§Ù„ÙŠ: ${currentAbsent} Ø³Ø§Ø¹Ø©</span>
                        <span>Ø­Ø¯ Ø§Ù„Ø­Ø±Ù…Ø§Ù†: ${limit.toFixed(1)} Ø³Ø§Ø¹Ø©
                            <span class="info-icon ${infoIconClass}" onclick="openLimitInfo(${weeklyH}, ${limit})">i</span>
                        </span>
                    </div>
                    ${advice}
                </div>
            `;
            list.appendChild(card);
        });

        localStorage.setItem('myCourses', JSON.stringify(courses));
    }

    function handleInput(id, field, el) {
        el.value = fixNumbers(el.value);
        updateCourse(id, field, el.value);
    }

    function updateCourse(id, field, value) {
        const index = courses.findIndex(c => c.id === id);
        if (index !== -1) {
            courses[index][field] = value;
            if (field === 'weeklyHours') {
                courses[index].absent1 = '';
                courses[index].absent2 = '';
            }
            renderCourses();
        }
    }

    function deleteCourse(id) {
        if(confirm('Ø­Ø°Ù Ø§Ù„Ù…Ù‚Ø±Ø±ØŸ')) {
            courses = courses.filter(c => c.id !== id);
            renderCourses();
        }
    }

    function clearEverything() {
        if(confirm('Ø¥Ø¹Ø§Ø¯Ø© Ø¶Ø¨Ø· ÙƒØ§ÙØ© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§ØªØŸ')) {
            courses = [];
            localStorage.removeItem('myCourses');
            renderCourses();
        }
    }

    window.onload = renderCourses;
</script>

</body>
</html>
