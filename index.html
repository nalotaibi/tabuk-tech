<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>رادار الحرمان الذكي - رقمية تبوك</title>
    <style>
        :root {
            --primary: #1d5c41;
            --safe: #22c55e;
            --warning: #f59e0b;
            --danger: #ef4444;
            --badge-bg: #e8f5e9;
            --badge-text: #2e7d32;
            --gray: #718096;
        }

        body {
            margin: 0;
            font-family: 'Segoe UI', Tahoma, sans-serif;
            background: linear-gradient(135deg, #e0eafc 0%, #cfdef3 100%);
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            direction: rtl;
        }

        .glass-card {
            background: #f0f4f8; 
            border-radius: 32px;
            padding: 30px;
            width: 90%;
            max-width: 420px;
            box-shadow: 0 20px 50px rgba(0,0,0,0.1);
            border: 1px solid #d1d9e6;
        }

        .app-header-centered { text-align: center; margin-bottom: 25px; }
        .college-logo img { width: 140px; height: auto; margin-bottom: 10px; filter: drop-shadow(0 2px 4px rgba(0,0,0,0.1)); }
        .header-text h1 { margin: 5px 0; font-size: 1.5rem; color: var(--primary); font-weight: 800; }
        .system-badge { display: inline-block; padding: 4px 14px; background-color: var(--badge-bg); color: var(--badge-text); border-radius: 20px; font-size: 0.8rem; font-weight: bold; }
        
        .absent-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 15px; margin: 20px 0; }
        .input-box { display: flex; flex-direction: column; align-items: center; text-align: center; }
        .form-group label, .input-box label { display: block; font-size: 0.85rem; font-weight: 600; color: #4a5568; margin-bottom: 8px; }
        
        /* التعديل الجذري للهوامش والمحاذاة */
        input, select { 
            width: 100%; 
            padding: 12px 20px; /* زيادة الهامش الجانبي */
            border: 1.5px solid #d1d9e6; 
            border-radius: 14px; 
            font-size: 0.95rem; 
            box-sizing: border-box; 
            outline: none; 
            transition: 0.3s; 
            background: white; 
            text-align: center;
            appearance: none;
            -webkit-appearance: none;
        }

        /* إضافة سهم اختيار مخصص لضمان عدم تداخله مع النص */
        select {
            background-image: url("data:image/svg+xml;charset=UTF-8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='20' height='20' viewBox='0 0 24 24' fill='none' stroke='%231d5c41' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3E%3Cpolyline points='6 9 12 15 18 9'%3E%3C/polyline%3E%3C/svg%3E");
            background-repeat: no-repeat;
            background-position: left 15px center;
            background-size: 14px;
            cursor: pointer;
        }

        input:focus { border-color: var(--primary); box-shadow: 0 0 0 3px rgba(29, 92, 65, 0.1); }

        .reset-btn {
            width: 100%; padding: 10px; margin-top: 5px; background: transparent; color: var(--gray);
            border: 1px dashed var(--gray); border-radius: 12px; cursor: pointer; font-size: 0.8rem; font-weight: 600; transition: 0.3s;
        }
        .reset-btn:hover { background: #fee2e2; color: var(--danger); border-style: solid; border-color: var(--danger); }

        .result-display { border-radius: 24px; padding: 25px; text-align: center; transition: 0.4s; margin-top: 10px; }
        .safe-mode { background: rgba(255, 255, 255, 0.7); border: 1px solid #d1d9e6; }
        .warning-mode { background: #fff9e6; border: 1px solid #fef3d1; }
        .danger-mode { background: #fff5f5; border: 1px solid #fee2e2; }

        .main-metric h2 { font-size: 2.4rem; margin: 10px 0; color: var(--primary); }
        .m-value { font-size: 1.1rem; font-weight: 800; }
        .progress-track { background: #e2e8f0; height: 10px; border-radius: 10px; overflow: hidden; margin-top: 10px; }
        .progress-thumb { height: 100%; width: 0%; transition: 1s ease-in-out; }
        
        .app-footer { margin-top: 25px; padding-top: 15px; border-top: 1px solid #d1d9e6; text-align: center; }
        .signature { font-size: 0.75rem; color: var(--primary); font-weight: 700; }
        .form-group { text-align: center; margin-bottom: 15px; }
    </style>
</head>
<body>

<div class="app-wrapper">
    <div class="glass-card">
        <header class="app-header-centered">
            <div class="college-logo">
                <img src="logo.png" alt="شعار المؤسسة">
            </div>
            <div class="header-text">
                <h1>رادار الحرمان الذكي</h1>
                <div class="badge-container">
                    <span class="system-badge">نظام الـ 16 أسبوعاً (20%)</span>
                </div>
            </div>
        </header>

        <div class="input-container">
            <div class="form-group">
                <label>عدد ساعات المقرر الأسبوعية</label>
                <select id="courseHours" onchange="calculate()">
                    <option value="1">1 ساعة</option>
                    <option value="2">2 ساعة</option>
                    <option value="3">3 ساعات</option>
                    <option value="4" selected>4 ساعات</option>
                    <option value="5">5 ساعات</option>
                    <option value="6">6 ساعات</option>
                </select>
            </div>

            <div class="absent-grid">
                <div class="input-box">
                    <label>غياب (ساعة واحدة)</label>
                    <input type="text" id="count1" placeholder="أدخل المرات" oninput="fixArabicNumbers(this)">
                </div>
                <div class="input-box">
                    <label>غياب (ساعتين)</label>
                    <input type="text" id="count2" placeholder="أدخل المرات" oninput="fixArabicNumbers(this)">
                </div>
            </div>
            <button class="reset-btn" onclick="resetApp()">↺ مسح البيانات</button>
        </div>

        <div id="statusBox" class="result-display safe-mode">
            <div class="main-metric">
                <span class="metric-label">الرصيد المتبقي قبل الحرمان</span>
                <h2 id="leftRes">--</h2>
            </div>
            <div class="metrics-row" style="display: flex; justify-content: space-around; align-items: center; margin: 15px 0;">
                <div class="metric-item">
                    <span style="font-size: 0.75rem; color: #718096; display: block;">نسبة الغياب</span>
                    <span id="percentRes" class="m-value">0%</span>
                </div>
                <div style="width: 1px; height: 30px; background: #d1d9e6;"></div>
                <div class="metric-item">
                    <span style="font-size: 0.75rem; color: #718096; display: block;">ساعات الغياب</span>
                    <span id="hoursRes" class="m-value">0</span>
                </div>
            </div>
            <div class="progress-section">
                <div style="display: flex; justify-content: space-between; font-size: 0.75rem; color: #718096; margin-bottom: 5px;">
                    <span>مؤشر القرب من الحرمان</span>
                    <span id="limitHours">--</span>
                </div>
                <div class="progress-track">
                    <div id="progressBar" class="progress-thumb"></div>
                </div>
            </div>
        </div>

        <footer class="app-footer">
            <p class="signature">إعداد وتصميم أ. نورة القثامي - قسم الحاسب وتقنية المعلومات</p>
        </footer>
    </div>
</div>

<script>
function fixArabicNumbers(el) {
    const arabicDigits = [/٠/g, /١/g, /٢/g, /٣/g, /٤/g, /٥/g, /٦/g, /٧/g, /٨/g, /٩/g];
    let val = el.value;
    for (let i = 0; i < 10; i++) {
        val = val.replace(arabicDigits[i], i);
    }
    el.value = val.replace(/[^\d]/g, ''); 
    calculate(); 
}

function resetApp() {
    document.getElementById('count1').value = '';
    document.getElementById('count2').value = '';
    document.getElementById('courseHours').selectedIndex = 3;
    calculate();
}

function calculate() {
    const hoursInPlan = parseInt(document.getElementById('courseHours').value);
    const c1 = parseFloat(document.getElementById('count1').value) || 0;
    const c2 = parseFloat(document.getElementById('count2').value) || 0;
    const actualAbsentHours = (c1 * 1) + (c2 * 2);
    const totalSemesterHours = hoursInPlan * 16;
    const limitHours = totalSemesterHours * 0.20;
    const currentPercent = (actualAbsentHours / totalSemesterHours) * 100;
    const remainingHours = limitHours - actualAbsentHours;

    document.getElementById('percentRes').innerText = currentPercent.toFixed(1) + "%";
    document.getElementById('hoursRes').innerText = actualAbsentHours;
    document.getElementById('limitHours').innerText = `الحد الأقصى: ${limitHours.toFixed(1)} ساعة`;
    
    const leftRes = document.getElementById('leftRes');
    const thumb = document.getElementById('progressBar');
    const statusBox = document.getElementById('statusBox');

    thumb.style.width = Math.min(currentPercent, 100) + "%";

    if (actualAbsentHours >= limitHours) {
        leftRes.innerText = "حرمان";
        leftRes.style.color = "var(--danger)";
        statusBox.className = "result-display danger-mode";
        thumb.style.background = "var(--danger)";
    } else {
        leftRes.innerText = (actualAbsentHours === 0) ? "--" : Math.floor(remainingHours) + " ساعة متبقية";
        leftRes.style.color = "var(--primary)";
        if (currentPercent > 15) {
            statusBox.className = "result-display warning-mode";
            thumb.style.background = "var(--warning)";
        } else {
            statusBox.className = "result-display safe-mode";
            thumb.style.background = "var(--safe)";
        }
    }
}
window.onload = calculate;
</script>
</body>
</html>
